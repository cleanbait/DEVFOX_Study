<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="devfox.study.board.dao.boardMapper">

	<insert id="write" parameterType="board">
		insert into board (board_num, user_id, name, title, content, inputdate, hits)
		values (board_num_seq.nextval,#{user_id},1,#{title},#{content},sysdate,0)
	</insert>
	
	<select id="list" resultType="board">
		select * from board
	</select>
	
	<update id="addHits" parameterType="int">
		update board set
		hits = hits + 1
		where board_num = #{boardnum}
	</update>
	
	<select id="getBoard" parameterType="int" resultType="board">
		select * from board where board_num = #{boardnum}
	</select>
	
	<select id="getReply" parameterType="int" resultType="reply">
		select replynum, user_id, password, commentt, to_char(inputdate, 'YYYY-MM-DD') as inputdate
		from reply where board_num = #{boardnum}
		order by replynum
	</select>
	
	<delete id="delete" parameterType="int">
		delete from board where board_num = #{boardnum}
	</delete>
	
	<update id="editBoard" parameterType="board">
		update board set 
		title = #{title},
		content = #{content}
		where board_num = #{board_num} and user_id = #{user_id}
	</update>
	
	<select id="replyData" parameterType="reply" resultType="reply">
		select replynum, user_id, password, commentt, to_char(inputdate, 'YYYY-MM-DD') as inputdate
		from reply where board_num = #{board_num}
		order by replynum
	</select>
	
	<insert id="reply" parameterType="reply">
		insert into reply (replynum, board_num, user_id, password, commentt, inputdate)
		values (replynum_seq.nextval, #{board_num}, #{user_id}, #{password}, #{commentt}, sysdate)
	</insert>
	
	<delete id="reply_delete" parameterType="int">
		delete from reply where replynum = #{replynum}
	</delete>
</mapper>